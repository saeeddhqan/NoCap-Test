tokens per iteration: 524,288
DataLoader: total number of tokens: 5,000,000,000 across 50 files
DataLoader: total number of tokens: 100,000,000 across 1 files
Traceback (most recent call last):
  File "/workspace/NoCap-Test/train_gpt2.py", line 552, in <module>
    model = GPT(model_config)
            ^^^^^^^^^^^^^^^^^
  File "/workspace/NoCap-Test/train_gpt2.py", line 224, in __init__
    h=nn.ModuleList([Block(config, idx=idx, method='attn') for idx in range(config.n_layer)]),
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/NoCap-Test/train_gpt2.py", line 192, in __init__
    self.moe = stu.SpectralMoEHeads(config.n_embd, config.n_embd, 1024)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: SpectralMoEHeads.__init__() missing 2 required positional arguments: 'num_heads' and 'max_seq_len'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/workspace/NoCap-Test/train_gpt2.py", line 552, in <module>
[rank0]:     model = GPT(model_config)
[rank0]:             ^^^^^^^^^^^^^^^^^
[rank0]:   File "/workspace/NoCap-Test/train_gpt2.py", line 224, in __init__
[rank0]:     h=nn.ModuleList([Block(config, idx=idx, method='attn') for idx in range(config.n_layer)]),
[rank0]:                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/workspace/NoCap-Test/train_gpt2.py", line 192, in __init__
[rank0]:     self.moe = stu.SpectralMoEHeads(config.n_embd, config.n_embd, 1024)
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: TypeError: SpectralMoEHeads.__init__() missing 2 required positional arguments: 'num_heads' and 'max_seq_len'
